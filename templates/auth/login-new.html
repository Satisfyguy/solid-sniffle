{% extends "base-marketplace.html" %}

{% block title %}Login - NEXUS{% endblock %}

{% block content %}

<div class="container flex items-center justify-center px-4 py-16 md:py-24">
    <div class="w-full max-w-md space-y-8">
        <!-- Trust Badges -->
        <div class="text-center space-y-4 animate-slide-up">
            <h1 class="text-4xl font-bold">Welcome to NEXUS</h1>
            <p class="text-muted-foreground">Your Market. Your Keys. Your Privacy.</p>

            <div class="flex items-center justify-center gap-6 pt-4">
                <div class="flex flex-col items-center gap-2">
                    <div class="h-12 w-12 rounded-full" style="background-color: hsl(var(--primary) / 0.1); display: flex; align-items: center; justify-content: center;">
                        <svg class="lucide" viewBox="0 0 24 24" style="color: hsl(var(--primary)); width: 1.5rem; height: 1.5rem;">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/>
                        </svg>
                    </div>
                    <span class="text-xs text-muted-foreground">Secure</span>
                </div>
                <div class="flex flex-col items-center gap-2">
                    <div class="h-12 w-12 rounded-full" style="background-color: hsl(var(--primary) / 0.1); display: flex; align-items: center; justify-content: center;">
                        <svg class="lucide" viewBox="0 0 24 24" style="color: hsl(var(--primary)); width: 1.5rem; height: 1.5rem;">
                            <rect width="18" height="11" x="3" y="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                    </div>
                    <span class="text-xs text-muted-foreground">Private</span>
                </div>
                <div class="flex flex-col items-center gap-2">
                    <div class="h-12 w-12 rounded-full" style="background-color: hsl(var(--primary) / 0.1); display: flex; align-items: center; justify-content: center;">
                        <svg class="lucide" viewBox="0 0 24 24" style="color: hsl(var(--primary)); width: 1.5rem; height: 1.5rem;">
                            <circle cx="8" cy="18" r="4"/>
                            <path d="M12 18V2l7 4"/>
                        </svg>
                    </div>
                    <span class="text-xs text-muted-foreground">Your Keys</span>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="w-full animate-fade-in">
            <!-- Tab Buttons -->
            <div class="grid grid-cols-2 gap-2 p-1 bg-muted rounded-lg mb-4">
                <button
                    id="tab-login"
                    class="tab-btn active py-2 px-4 rounded-md transition-colors font-medium"
                    onclick="switchTab('login')"
                >
                    Login
                </button>
                <button
                    id="tab-signup"
                    class="tab-btn py-2 px-4 rounded-md transition-colors font-medium"
                    onclick="switchTab('signup')"
                >
                    Sign Up
                </button>
            </div>

            <!-- Login Form -->
            <div id="content-login" class="tab-content card">
                <div class="p-6 space-y-6">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Login to Your Account</h2>
                        <p class="text-muted-foreground text-sm">
                            Enter your username to access your NEXUS account
                        </p>
                    </div>

                    <form hx-post="/api/auth/login" hx-target="body" class="space-y-4">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

                        <div class="space-y-2">
                            <label for="login-username" class="text-sm font-medium">Username</label>
                            <input
                                id="login-username"
                                name="username"
                                type="text"
                                placeholder="Your username"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
                                required
                            />
                        </div>

                        <div class="space-y-2">
                            <label for="login-password" class="text-sm font-medium">Password</label>
                            <input
                                id="login-password"
                                name="password"
                                type="password"
                                placeholder="••••••••"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
                                required
                            />
                        </div>

                        <div class="flex items-center justify-between text-sm">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" name="remember" class="rounded">
                                <span class="text-muted-foreground">Remember me</span>
                            </label>
                        </div>

                        <button type="submit" class="btn btn-primary w-full">
                            Login
                        </button>
                    </form>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="content-signup" class="tab-content card hidden">
                <div class="p-6 space-y-6">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Create Your Account</h2>
                        <p class="text-muted-foreground text-sm">
                            Join NEXUS and start trading with complete privacy
                        </p>
                    </div>

                    <form hx-post="/api/auth/register" hx-target="body" class="space-y-4">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

                        <div class="space-y-2">
                            <label for="signup-username" class="text-sm font-medium">Username</label>
                            <input
                                id="signup-username"
                                name="username"
                                type="text"
                                placeholder="Choose a username"
                                minlength="3"
                                maxlength="50"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
                                required
                            />
                            <p class="text-xs text-muted-foreground">3-50 characters</p>
                        </div>

                        <div class="space-y-2">
                            <label for="signup-password" class="text-sm font-medium">Password</label>
                            <input
                                id="signup-password"
                                name="password"
                                type="password"
                                placeholder="••••••••"
                                minlength="8"
                                maxlength="128"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
                                required
                            />
                            <p class="text-xs text-muted-foreground">Minimum 8 characters</p>
                        </div>

                        <div class="space-y-2">
                            <label for="signup-confirm" class="text-sm font-medium">Confirm Password</label>
                            <input
                                id="signup-confirm"
                                name="confirm_password"
                                type="password"
                                placeholder="••••••••"
                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"
                                required
                            />
                        </div>

                        <!-- Role Selection -->
                        <div class="space-y-2">
                            <label class="text-sm font-medium">Account Type</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex flex-col items-center gap-2 p-4 border border-input rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="role" value="buyer" checked class="sr-only role-radio">
                                    <div class="role-icon h-12 w-12 rounded-full flex items-center justify-center transition-colors" style="background-color: hsl(var(--muted));">
                                        <svg class="lucide" viewBox="0 0 24 24" style="width: 1.5rem; height: 1.5rem;">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                                        </svg>
                                    </div>
                                    <span class="font-medium text-sm">Buyer</span>
                                    <span class="text-xs text-muted-foreground text-center">Shop with privacy</span>
                                </label>

                                <label class="flex flex-col items-center gap-2 p-4 border border-input rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="role" value="vendor" class="sr-only role-radio">
                                    <div class="role-icon h-12 w-12 rounded-full flex items-center justify-center transition-colors" style="background-color: hsl(var(--muted));">
                                        <svg class="lucide" viewBox="0 0 24 24" style="width: 1.5rem; height: 1.5rem;">
                                            <path d="M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z"/>
                                            <path d="m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9"/>
                                            <path d="M12 3v6"/>
                                        </svg>
                                    </div>
                                    <span class="font-medium text-sm">Vendor</span>
                                    <span class="text-xs text-muted-foreground text-center">Sell your products</span>
                                </label>
                            </div>
                        </div>

                        <div class="flex items-start gap-2">
                            <input type="checkbox" name="terms" class="mt-1 rounded" required />
                            <span class="text-sm text-muted-foreground">
                                I agree to the Terms of Service and Privacy Policy
                            </span>
                        </div>

                        <button type="submit" class="btn btn-primary w-full">
                            Create Account
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="text-center text-sm text-muted-foreground">
            <p>By continuing, you agree to our secure, non-custodial architecture.</p>
            <p class="mt-2">No email required. Monero address is optional (for vendors).</p>
        </div>
    </div>
</div>

<style>
.tab-btn {
    background-color: transparent;
    color: hsl(var(--muted-foreground));
    border: none;
    cursor: pointer;
}

.tab-btn.active {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
}

.tab-content {
    animation: fade-in 0.3s ease-out;
}

/* Role selection styles */
label:has(.role-radio:checked) {
    border-color: hsl(var(--primary));
    background-color: hsl(var(--primary) / 0.05);
}

label:has(.role-radio:checked) .role-icon {
    background-color: hsl(var(--primary) / 0.1);
    color: hsl(var(--primary));
}

label:has(.role-radio:checked) .lucide {
    color: hsl(var(--primary));
}
</style>

<script>
function switchTab(tab) {
    // Update buttons
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.getElementById('tab-' + tab).classList.add('active');

    // Update content
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
    });
    document.getElementById('content-' + tab).classList.remove('hidden');
}

// Password confirmation validation
document.addEventListener('DOMContentLoaded', function() {
    const signupForm = document.querySelector('#content-signup form');
    if (signupForm) {
        signupForm.addEventListener('submit', function(e) {
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;

            if (password !== confirm) {
                e.preventDefault();
                alert('Passwords do not match!');
                return false;
            }
        });
    }
});
</script>

{% endblock %}
