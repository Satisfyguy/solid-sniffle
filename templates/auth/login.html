{% extends "base-nexus.html" %}

{% block title %}Login — NEXUS{% endblock %}

{% block content %}

{# Auth Container - Centered layout #}
<section style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: var(--nexus-space-6);">
  <div style="width: 100%; max-width: 500px;">

    {# Logo/Brand #}
    <div style="text-align: center; margin-bottom: var(--nexus-space-8);">
      <h1 style="font-size: var(--nexus-text-4xl); font-weight: var(--nexus-weight-black); color: var(--nexus-fg); text-transform: uppercase; letter-spacing: var(--nexus-tracking-tight); margin: 0;">
        NEXUS
      </h1>
      <p style="font-size: var(--nexus-text-sm); color: var(--nexus-muted-fg); margin-top: var(--nexus-space-2); text-transform: uppercase; letter-spacing: var(--nexus-tracking-wide);">
        Secure Privacy-Focused Marketplace
      </p>
    </div>

    {# Login Card #}
    {% include "partials/nexus/molecules/card.html" %}

  </div>
</section>

{% endblock %}

{% block scripts %}
<style>
/* HTMX indicator animation */
.htmx-indicator.htmx-request {
  display: block !important;
  animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Full width button utility */
.w-full {
  width: 100%;
}
</style>

<script>
// Handle HTMX response
document.body.addEventListener('htmx:afterRequest', function(event) {
  const authResult = document.getElementById('auth-result');

  if (event.detail.successful) {
    const xhr = event.detail.xhr;

    // Check if response indicates success (e.g., redirect or success message)
    if (xhr.status === 200) {
      // Success - show success message and redirect
      authResult.innerHTML = `
        <div style="padding: var(--nexus-space-4); background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: var(--nexus-radius-md); color: var(--nexus-success);">
          ✓ Login successful! Redirecting...
        </div>
      `;

      // Redirect after short delay
      setTimeout(() => {
        window.location.href = '/';
      }, 1000);
    }
  } else {
    // Error - show error message
    authResult.innerHTML = `
      <div style="padding: var(--nexus-space-4); background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: var(--nexus-radius-md); color: var(--nexus-destructive);">
        ✗ Login failed. Please check your credentials.
      </div>
    `;
  }
});
</script>
{% endblock %}
