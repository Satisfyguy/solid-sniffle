{% extends "base-geometric.html" %}

{% block title %}NEXUS Geometric - Homepage{% endblock %}
{% block page_id %}geometric-home{% endblock %}

{% block content %}
<!-- Geometric Canvas Container -->
<div class="geometric-canvas" id="geometricCanvas">

  <!-- Main SVG with Navigation Shapes -->
  <svg viewBox="0 0 1920 1080" preserveAspectRatio="xMidYMid slice" class="geo-svg-main" role="img" aria-label="Geometric navigation interface">

    <!-- ========================================
         NAVIGATION SHAPES (6)
         ======================================== -->

    <!-- FORME 1: LOGIN (Circle Rose, Haut-Gauche) -->
    <g class="geo-nav-item" data-href="/login" data-color="pink" role="button" tabindex="0" aria-label="Login page">
      <circle cx="200" cy="150" r="80" fill="var(--geo-pink)" class="geo-shape" />
      <text x="200" y="155" class="geo-label">LOGIN</text>
    </g>

    <!-- FORME 2: REGISTER (Arc Jaune, Haut-Centre) -->
    <g class="geo-nav-item" data-href="/register" data-color="yellow" role="button" tabindex="0" aria-label="Register page">
      <!-- Arc shape using path -->
      <path d="M 800 100 A 120 120 0 0 1 1040 100"
            fill="none"
            stroke="var(--geo-yellow)"
            stroke-width="40"
            class="geo-shape"
            stroke-linecap="round" />
      <text x="920" y="80" class="geo-label">REGISTER</text>
    </g>

    <!-- FORME 3: LISTINGS (Large Arch Bleu, Centre) -->
    <g class="geo-nav-item" data-href="/listings" data-color="blue" role="button" tabindex="0" aria-label="Marketplace listings">
      <!-- Large arch shape -->
      <path d="M 600 400 Q 960 200 1320 400"
            fill="var(--geo-blue)"
            class="geo-shape" />
      <text x="960" y="350" class="geo-label" font-size="16">LISTINGS</text>
    </g>

    <!-- FORME 4: ORDERS (Circle Rose, Droite) -->
    <g class="geo-nav-item" data-href="/orders" data-color="pink" role="button" tabindex="0" aria-label="My orders">
      <circle cx="1600" cy="300" r="100" fill="var(--geo-pink)" class="geo-shape" />
      <text x="1600" y="310" class="geo-label">ORDERS</text>
    </g>

    <!-- FORME 5: ESCROW (Triangle Turquoise, Bas-Centre) -->
    <g class="geo-nav-item" data-href="/escrow" data-color="turquoise" role="button" tabindex="0" aria-label="Escrow management">
      <polygon points="960,700 1100,850 820,850"
               fill="var(--geo-turquoise)"
               class="geo-shape" />
      <text x="960" y="820" class="geo-label">ESCROW</text>
    </g>

    <!-- FORME 6: SETTINGS (Cactus Turquoise, Bas-Gauche) -->
    <g class="geo-nav-item" data-href="/settings" data-color="turquoise" role="button" tabindex="0" aria-label="Settings">
      <!-- Cactus body -->
      <rect x="150" y="700" width="60" height="120" rx="8" fill="var(--geo-turquoise)" class="geo-shape" />
      <!-- Left arm -->
      <circle cx="140" cy="780" r="20" fill="var(--geo-turquoise)" class="geo-shape" />
      <!-- Right arm -->
      <circle cx="220" cy="750" r="15" fill="var(--geo-turquoise)" class="geo-shape" />
      <text x="180" y="840" class="geo-label" font-size="12">SETTINGS</text>
    </g>

    <!-- ========================================
         DECORATIVE SHAPES (Parallax Background)
         ======================================== -->

    <!-- Row 1: Top decorations -->
    <circle cx="1400" cy="100" r="40" fill="var(--geo-yellow)" class="geo-decor float-1" data-speed="0.02" opacity="0.5" />
    <rect x="100" y="400" width="60" height="60" rx="12" fill="var(--geo-pink)" class="geo-decor pulse-1" data-speed="0.04" opacity="0.4" />
    <circle cx="1700" cy="200" r="30" fill="var(--geo-blue)" class="geo-decor float-2" data-speed="0.03" opacity="0.6" />

    <!-- Row 2: Middle decorations -->
    <polygon points="500,200 550,250 500,300 450,250"
             fill="var(--geo-turquoise)"
             class="geo-decor pulse-2"
             data-speed="0.05"
             opacity="0.5" />
    <rect x="1500" cy="500" width="80" height="80" rx="16" fill="var(--geo-yellow)" class="geo-decor float-3" data-speed="0.03" opacity="0.4" />
    <circle cx="300" cy="600" r="50" fill="var(--geo-blue)" class="geo-decor pulse-1" data-speed="0.04" opacity="0.3" />

    <!-- Row 3: Bottom decorations -->
    <circle cx="1700" cy="800" r="60" fill="var(--geo-turquoise)" class="geo-decor float-1" data-speed="0.02" opacity="0.5" />
    <rect x="400" y="850" width="70" height="70" rx="14" fill="var(--geo-pink)" class="geo-decor pulse-2" data-speed="0.05" opacity="0.4" />
    <polygon points="1300,900 1350,950 1300,1000 1250,950"
             fill="var(--geo-yellow)"
             class="geo-decor float-2"
             data-speed="0.03"
             opacity="0.6" />

    <!-- Additional scattered decorations -->
    <circle cx="700" cy="100" r="25" fill="var(--geo-pink)" class="geo-decor pulse-1" data-speed="0.04" opacity="0.3" />
    <rect x="1100" y="600" width="40" height="40" rx="8" fill="var(--geo-turquoise)" class="geo-decor float-3" data-speed="0.02" opacity="0.5" />
    <circle cx="450" cy="450" r="35" fill="var(--geo-yellow)" class="geo-decor pulse-2" data-speed="0.05" opacity="0.4" />
    <polygon points="1750,500 1790,540 1750,580 1710,540"
             fill="var(--geo-blue)"
             class="geo-decor float-1"
             data-speed="0.03"
             opacity="0.5" />
    <rect x="600" y="750" width="55" height="55" rx="10" fill="var(--geo-pink)" class="geo-decor pulse-1" data-speed="0.04" opacity="0.4" />
    <circle cx="1150" cy="200" r="45" fill="var(--geo-turquoise)" class="geo-decor float-2" data-speed="0.03" opacity="0.3" />

  </svg>

</div>

<!-- ========================================
     MODAL ONBOARDING
     ======================================== -->
<div id="geoOnboardingModal" class="geo-modal" style="display: none;" role="dialog" aria-labelledby="modalTitle" aria-modal="true">
  <div class="geo-modal-content">
    <h2 id="modalTitle" class="geo-heading-2">Bienvenue sur NEXUS Geometric 🎨</h2>
    <p class="geo-modal-text">
      Une nouvelle façon de naviguer ! Explorez le marketplace en cliquant sur les formes géométriques colorées.
    </p>

    <div class="geo-modal-features">
      <div class="geo-feature-item">
        <span class="geo-feature-icon">🔵</span>
        <span>Cliquez sur les formes pour naviguer</span>
      </div>
      <div class="geo-feature-item">
        <span class="geo-feature-icon">✨</span>
        <span>Survolez pour voir les labels</span>
      </div>
      <div class="geo-feature-item">
        <span class="geo-feature-icon">🔒</span>
        <span>100% privé via Tor + Monero</span>
      </div>
    </div>

    <div class="geo-modal-buttons">
      <button id="skipTour" class="geo-btn-secondary" aria-label="Skip tutorial">
        Passer
      </button>
      <button id="startTour" class="geo-btn-primary" aria-label="Start tutorial">
        Démarrer le Tour
      </button>
    </div>
  </div>
</div>

<!-- ========================================
     TOAST QUICK BUY
     ======================================== -->
<div id="geoQuickBuyToast" class="geo-toast" style="display: none;" role="alert" aria-live="polite">
  <div class="geo-toast-content">
    <div class="geo-toast-icon">💡</div>
    <div class="geo-toast-text">
      <strong>Vous cherchez à acheter rapidement ?</strong>
      <p>Accédez directement aux listings disponibles</p>
    </div>
    <a href="/listings" class="geo-btn-primary-sm">Voir les Listings</a>
  </div>
  <button class="geo-toast-close" aria-label="Fermer la notification">✕</button>
</div>

<!-- ========================================
     USER MENU (Only if logged in)
     ======================================== -->
{% if logged_in %}
<div class="geo-user-menu" id="geoUserMenu">
  <button class="geo-user-avatar" id="geoUserAvatar" aria-label="Menu utilisateur" aria-expanded="false" aria-haspopup="true">
    {{ username[0]|upper }}
  </button>

  <div class="geo-user-dropdown" id="geoUserDropdown" style="display: none;" role="menu" aria-labelledby="geoUserAvatar">
    <div class="geo-user-info">
      <strong>{{ username }}</strong>
      {% if role %}
      <span class="geo-user-role">{{ role }}</span>
      {% endif %}
    </div>
    <hr class="geo-divider">
    <a href="/profile" role="menuitem" tabindex="0">
      <span class="geo-menu-icon">👤</span> Mon Profil
    </a>
    <a href="/orders" role="menuitem" tabindex="0">
      <span class="geo-menu-icon">📦</span> Mes Commandes
    </a>
    <a href="/settings" role="menuitem" tabindex="0">
      <span class="geo-menu-icon">⚙️</span> Paramètres
    </a>
    {% if role == "vendor" %}
    <hr class="geo-divider">
    <a href="/vendor/dashboard" role="menuitem" tabindex="0">
      <span class="geo-menu-icon">📊</span> Dashboard Vendeur
    </a>
    <a href="/vendor/listings" role="menuitem" tabindex="0">
      <span class="geo-menu-icon">📝</span> Mes Listings
    </a>
    {% endif %}
    <hr class="geo-divider">
    <a href="/logout" role="menuitem" tabindex="0" class="geo-menu-logout">
      <span class="geo-menu-icon">🚪</span> Déconnexion
    </a>
  </div>
</div>
{% else %}
<!-- Login/Register buttons for non-authenticated users -->
<div class="geo-auth-buttons">
  <a href="/login" class="geo-btn-secondary-sm">Login</a>
  <a href="/register" class="geo-btn-primary-sm">Register</a>
</div>
{% endif %}

<!-- ========================================
     VERSION BADGE (Bottom-Right)
     ======================================== -->
<div class="geo-version-badge">
  <span class="geo-version-text">v0.2.6-alpha</span>
  <span class="geo-version-status">MVP</span>
</div>

{% endblock %}

{% block extra_js %}
<script>
  // Homepage-specific JavaScript
  if (window.NEXUS_DEBUG) {
    console.log('[NEXUS DEBUG] Geometric Homepage initialized');
    console.log('[NEXUS DEBUG] Navigation shapes:', document.querySelectorAll('.geo-nav-item').length);
    console.log('[NEXUS DEBUG] Decorative shapes:', document.querySelectorAll('.geo-decor').length);
  }
</script>
{% endblock %}
