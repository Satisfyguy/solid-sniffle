{#
  NEXUS NAVIGATION COMPONENT

  Expects from Rust context:
    - logged_in: bool
    - user_name: Option<String>
    - notifications_count: Option<i32>
#}

<nav class="nexus-nav nexus-nav-glass nexus-nav-sticky">
  <div class="nexus-nav-container">
    {# Logo #}
    <a href="/" class="nexus-nav-logo" hx-boost="true">
      <span class="nexus-nav-logo-text">NEXUS</span>
    </a>

    {# Desktop Navigation #}
    <div class="nexus-nav-menu">
      <a href="/listings" class="nexus-nav-link" hx-boost="true">Browse</a>
      <a href="/categories" class="nexus-nav-link" hx-boost="true">Categories</a>
      <a href="/vendors" class="nexus-nav-link" hx-boost="true">Vendors</a>
    </div>

    {# Right Side Actions #}
    <div class="nexus-nav-actions">
      {% if logged_in %}
        {# Authenticated User #}
        <a href="/orders" class="nexus-nav-link" hx-boost="true">
          My Orders
        </a>

        {# Notifications #}
        {% if notifications_count and notifications_count > 0 %}
          <button class="nexus-nav-icon-btn" aria-label="Notifications">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            <span class="nexus-badge nexus-badge-destructive" style="position: absolute; top: -4px; right: -4px; min-width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; padding: 2px 4px; font-size: 10px;">
              {{ notifications_count }}
            </span>
          </button>
        {% endif %}

        {# User Menu #}
        <div class="nexus-nav-user-menu">
          <button class="nexus-nav-user-btn" aria-label="User menu">
            <span>{{ user_name | default(value="User") }}</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>

          <div class="nexus-nav-dropdown">
            <a href="/settings" class="nexus-nav-dropdown-item" hx-boost="true">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
              Settings
            </a>

            <hr style="margin: 8px 0; border: none; border-top: 1px solid var(--nexus-border);">

            <form action="/logout" method="POST" style="margin: 0;">
              <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
              <button type="submit" class="nexus-nav-dropdown-item" style="width: 100%; text-align: left; border: none; background: none; cursor: pointer; padding: 12px 16px; font-size: 14px; color: var(--nexus-destructive);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                  <polyline points="16 17 21 12 16 7"></polyline>
                  <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout
              </button>
            </form>
          </div>
        </div>
      {% else %}
        {# Guest User - Premium NEXUS Auth Buttons #}
        <a href="/login" class="nexus-btn nexus-btn-ghost nexus-btn-sm" hx-boost="true" style="margin-right: 0.75rem; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
            <polyline points="10 17 15 12 10 7"></polyline>
            <line x1="15" y1="12" x2="3" y2="12"></line>
          </svg>
          Login
        </a>
        <a href="/register" class="nexus-btn nexus-btn-primary nexus-btn-sm" hx-boost="true" style="position: relative; overflow: hidden; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 600; box-shadow: 0 0 20px rgba(255, 26, 92, 0.3);">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <line x1="19" y1="8" x2="19" y2="14"></line>
            <line x1="22" y1="11" x2="16" y2="11"></line>
          </svg>
          Sign Up
          <span class="nexus-btn-glow" style="position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent); transform: translateX(-100%); animation: nexus-btn-shine 3s infinite;"></span>
        </a>
      {% endif %}

      {# Mobile Menu Toggle #}
      <button class="nexus-nav-mobile-toggle" aria-label="Toggle mobile menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</nav>
