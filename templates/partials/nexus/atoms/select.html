{#
  NEXUS SELECT COMPONENT

  Usage:
    {% include "partials/nexus/atoms/select.html" with
       name="category"
       options=[
         {value: "electronics", label: "Electronics"},
         {value: "services", label: "Services"}
       ]
       selected="electronics"
    %}

  Parameters:
    - name (required): Select name attribute
    - options (required): Array of {value, label} objects
    - selected (optional): Pre-selected value
    - label (optional): Label text
    - placeholder (optional): Placeholder option text
    - required (optional): true|false (default: false)
    - disabled (optional): true|false (default: false)
    - error (optional): Error message
    - class (optional): Additional CSS classes
    - id (optional): Element ID
    - hx_get (optional): HTMX GET endpoint
    - hx_target (optional): HTMX target
    - hx_trigger (optional): HTMX trigger (default: change)
#}

{% set select_id = id | default(value=name) %}
{% set select_required = required | default(value=false) %}
{% set select_disabled = disabled | default(value=false) %}

{# Build CSS classes #}
{% set css_classes = "nexus-input nexus-select" %}
{% if error %}
  {% set css_classes = css_classes ~ " nexus-input-error" %}
{% endif %}
{% if class %}
  {% set css_classes = css_classes ~ " " ~ class %}
{% endif %}

<div class="nexus-input-wrapper">
  {# Label #}
  {% if label %}
    <label for="{{ select_id }}" class="nexus-label">
      {{ label }}
      {% if select_required %}<span class="nexus-label-required">*</span>{% endif %}
    </label>
  {% endif %}

  {# Select field #}
  <select
    id="{{ select_id }}"
    name="{{ name }}"
    class="{{ css_classes }}"
    {% if select_required %}required{% endif %}
    {% if select_disabled %}disabled{% endif %}
    {% if error %}aria-invalid="true" aria-describedby="{{ select_id }}-error"{% endif %}
    {% if hx_get %}hx-get="{{ hx_get }}"{% endif %}
    {% if hx_target %}hx-target="{{ hx_target }}"{% endif %}
    {% if hx_trigger %}hx-trigger="{{ hx_trigger }}"{% else %}{% if hx_get %}hx-trigger="change"{% endif %}{% endif %}
  >
    {# Placeholder option #}
    {% if placeholder %}
      <option value="" disabled {% if not selected %}selected{% endif %}>{{ placeholder }}</option>
    {% endif %}

    {# Options #}
    {% for option in options %}
      <option
        value="{{ option.value }}"
        {% if selected and selected == option.value %}selected{% endif %}
      >
        {{ option.label }}
      </option>
    {% endfor %}
  </select>

  {# Error message #}
  {% if error %}
    <span id="{{ select_id }}-error" class="nexus-input-error-message" role="alert">
      {{ error }}
    </span>
  {% endif %}
</div>

<style>
.nexus-select {
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23f5f5f5' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--nexus-space-3) center;
  padding-right: var(--nexus-space-8);
  cursor: pointer;
}
</style>
