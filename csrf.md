
Hello everybody and welcome back to brand new Datflow video. Please, if you're new here, make sure to subscribe. We're trying to hit 100,000 subscribers by the end of the year. So, if you're new, welcome. And today, actually, we're going to be talking about a vulnerability found on Brave, but it actually gets a bit more complicated and the vulnerability title is same site restrictions are lifted and same site strict cookies are being sent. Uh, that actually does sound scary, but today

we're actually going to be taking a step further and explaining everything you need to know about this vulnerability. And make sure to get my bug bounty course if you want to actually learn hacking and become good at this field. Also, my game hacking course also exists. And up top it all off, if you get either of them, you also get a free Aveno subscription forever. So, I think it's worth giving it a shot. Uh, now let's go with today's video. So, today's video is going to be about a

vulnerability found on a browser. But before we actually get into it, the same site strict cookies might actually be familiar to some of you, but might not be to most of you. So actually I'm going to just talk about them first before we actually get to the core of the vulnerability. The same site is basically a an attribute on a cookie on a set cookie header and what it actually does it is an optional header as it is an optional attribute as you can see but what it says is it controls whether or

not cookie is sent in cross-sight request that is requests originating from a different site including the scheme from the site that sent the cookie. uh and this provides some protection against certain cross-sight attacks including CSRF or cross-sight request forgery attacks. Uh this is why it becomes very important to understand what this actually does. And there's a few things few settings which you can set. It is strict, lax, and none. But we're going to be focusing on the strict because it is the most strict attribute

value which you can set. And it basically sends a cookie only for requests originating from the same site that set the cookie. If that actually is quite alienike to you, don't worry. I got you with a so paint explanation. So let's say you're logged in on a.com and once you complete the login, it basically sets a cookie using same site strict attribute like your session, let's say. And let's say a.com now redirects you back to dashboard. H it actually does that quite well because

all of the top level navigation requests or any requests happening within the site are coming from the domain which set the cookie that is a.com that is actually very straightforward nothing complaint nothing complete nothing complicated sorry but after you log in it sets the strict to same site and you basically can navigate around the map navigate around the a.com website and whichever request sent was from a.com referior let's say it will be passed through. However, now comes the B.com. And let's say the B.com just sends a

request to dashboard after you let's say press a button on the B.com. This triggers a top level navigation to the A.com from B.com. And since the same site strict was set on the session cookie, the browser knows that the referer from the request to the A from the B to A is b.com meaning the B actually triggered the top level navigation to A.com. the session cookie is not going to be included. Therefore, it just falls back to the login. So, just to repeat everything, you click a little button, let's say um in let's say

1 2 3. So, you click that button on b.com. It triggers a top level navigation to A and it actually let's say leads to dashboard and the browser midway understands that it's coming from B.com and C is oh A.com set strict to same site meaning don't include the session unless the request is coming from A but since it's coming from B just don't include the session and dashboard on the server side sees that you're actually aren't logged in because there is no session and it just takes you back

to log in. That is actually how same site strict cookies work. And hopefully I was clear. If I wasn't, you can re-re repeat this video. But it is actually a solid mechanism of defense against CSRF attack. As this article from mzilla.org or states, uh, it definitely can prevent CSRF attacks, but as this video will prove, that this is actually just another vulnerability we found in the browsers. But some websites might fall back to this as the defense of choice when in reality it should work flawlessly if there is a cookie on your

website. Just make sure to save it with same site strict and you don't have to worry about CSRF attacks. That actually brings us to the report. Same site restrictions are lifted and same site strict cookies are being sent. So what this actually means in just a translation of the report is let's take a look at it. So the steps that reproduce is you basically have this small snippet of code sends you to the same sitecheck.com website target is blank and there is 1 2 3 4 let's a button just similar to what I've

explained right over here. Okay try opening the hyperlink above this a anchor tag above using the open link in split view option and then you can see that even same site strict cookies are being sent. What this means is that if you open this link, if you press this button and you select the open link in split view, what actually happens is it will send a request from B, a top level navigation request from B to A to let's say dashboard and for some odd bug within the Chromium or whichever browser

it's actually responsible for this. It actually sends still the cookies and you don't actually get redirected to login. you stay on dashboard and this becomes a problem because most websites actually use same site strict as their only protection against CSRF attacks. So let's keep on reading and actually try opening the link using other options as well such as open a new tab or open an incognito window and compare the cookies that are sent in each case and demonstrating and the demonstration of

this is actually the pock the or proof of concept the reporter has submitted. So let's actually take a look at the video. So if we actually hit play, you can see that he is on the local host and after he clicks this button, it takes him to this uh other dream hack. And on that website, I assume he has the same site strict restriction set. And let's keep on going. So firstly, the cookies that are sent is lax cookies. So same site equals lax, which you know should be included once you navigate

from one website to another. That is not a bug. Okay. Uh interesting. So let's see what he does. Uh it is on Korean. I think this is Korean. So he's opening this in a new tab. Uh he refreshes the page and you can still see that the lax cookies are included. Uh now actually he's going to send open it in a whole new window. I don't know tab whatever. Uh let's I don't understand Korean. I'm sorry. And still see that the lax cookies but no strict cookies are included. And now he's going to what is

he going to do now? Okay. So now you open it in split view and it actually did include the strict cookies. Wow. That is actually a one scary vulnerability because as we just explained this shouldn't work. This right here. Oh my god, look at that car. But this shouldn't work because I've just explained it. And yeah, let's actually keep on reading and thanks for the report. We're taking a look and the actual brave software staff commented and said that this issue occurs in Chromium split implementation as well

which are we mitigating. So could you report it to their bug bounty and let us know what they say? You can test it by enabling side by side in Chrome flags and chrome beta. And he actually did report it to the Chrome. But I don't know how actually that went because uh when I uh once patch is completed, you will probably be able to view. Okay, so he actually reported that to the Google's bug bounty and we'll share the updates if he receives them. And he says, "Sorry for the reply. I reported

the issue to Google and found an additional issue besides the same site. So I ended up reporting it to Google later. uh and I have found confirmed that the issue is currently being patched in Chrome. Once patch is completed, you will probably be able to view the issue right here, which uh actually we are not able to view it because access is denied to this issue. So me and they're actually still working on a fix, which is quite insane. Also, would it be possible to receive a CV for this issue? Thank you. But Brave was

definitely at at some help and they actually gave him the $500 bounty, which I'm assuming Google will give him more for this issue. But there we go. Hopefully you enjoyed this video. Hopefully you learned something from it and hopefully you understand now what the set cookie restrictions are for what the same set restrictions are for the set cookie headers. Uh and hopefully this video was definitely educational and you found it super amusing as well. Thank you so much for watching this little video. Stay safe, stay

responsible.
